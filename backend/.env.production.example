# Backend Environment Variables - PRODUCTION
# Copy this file to .env.production and fill in with actual production values
# SECURITY: Never commit .env.production to version control!

# ============================================
# CRITICAL: Server Configuration
# ============================================
NODE_ENV=production
PORT=4000
HOST=0.0.0.0

# ============================================
# CRITICAL: Database Configuration
# ============================================
# Production PostgreSQL connection string
# Format: postgresql://user:password@host:port/database?sslmode=require
DATABASE_URL=postgresql://production_user:CHANGE_ME@production-host.example.com:5432/mediation_production?sslmode=require

# Optional: Individual database connection params
DATABASE_HOST=production-host.example.com
DATABASE_PORT=5432
DATABASE_NAME=mediation_production
DATABASE_USER=production_user
DATABASE_PASSWORD=CHANGE_ME

# ============================================
# CRITICAL: JWT & Authentication
# ============================================
# IMPORTANT: Generate strong secrets using: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
JWT_SECRET=CHANGE_ME_TO_64_CHAR_RANDOM_STRING_MINIMUM
DEV_JWT_SECRET=NOT_USED_IN_PRODUCTION

# JWT token expiration (7d = 7 days, 24h = 24 hours)
JWT_EXPIRES=7d

# ============================================
# CRITICAL: Session Configuration
# ============================================
# IMPORTANT: Generate strong session secret using: node -e "console.log(require('crypto').randomBytes(64).toString('hex'))"
SESSION_SECRET=CHANGE_ME_TO_64_CHAR_RANDOM_STRING_MINIMUM
SESSION_MAX_AGE=86400000

# ============================================
# CRITICAL: CORS & Frontend Configuration
# ============================================
# Production frontend URL (no trailing slash)
FRONTEND_URL=https://your-production-domain.com

# Allowed origins for CORS (comma-separated)
ALLOWED_ORIGINS=https://your-production-domain.com,https://www.your-production-domain.com

# ============================================
# CRITICAL: Supabase Configuration
# ============================================
# Get these from Supabase Project Settings → API
SUPABASE_URL=https://your-project-id.supabase.co
SUPABASE_SERVICE_ROLE_KEY=CHANGE_ME_TO_SUPABASE_SERVICE_ROLE_KEY
SUPABASE_ANON_KEY=CHANGE_ME_TO_SUPABASE_ANON_KEY
SUPABASE_JWT_SECRET=CHANGE_ME_TO_SUPABASE_JWT_SECRET

# ============================================
# CRITICAL: Email Service Configuration
# ============================================
# SendGrid Configuration (recommended)
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=apikey
SMTP_PASSWORD=CHANGE_ME_TO_SENDGRID_API_KEY

# Email sender details
FROM_EMAIL=noreply@your-domain.com
FROM_NAME=Your Mediation Platform

# Alternative: Mailgun Configuration
# SMTP_HOST=smtp.mailgun.org
# SMTP_PORT=587
# SMTP_USER=postmaster@your-domain.com
# SMTP_PASSWORD=CHANGE_ME_TO_MAILGUN_PASSWORD

# ============================================
# CRITICAL: File Storage (Cloudinary)
# ============================================
# Get these from Cloudinary Dashboard → Account Details
CLOUDINARY_CLOUD_NAME=CHANGE_ME_TO_CLOUDINARY_CLOUD_NAME
CLOUDINARY_API_KEY=CHANGE_ME_TO_CLOUDINARY_API_KEY
CLOUDINARY_API_SECRET=CHANGE_ME_TO_CLOUDINARY_API_SECRET

# ============================================
# CRITICAL: OpenAI Configuration
# ============================================
# Get API key from OpenAI Platform → API Keys
OPENAI_API_KEY=CHANGE_ME_TO_OPENAI_API_KEY
OPENAI_MODEL=gpt-4o-mini
OPENAI_MAX_TOKENS=2000
OPENAI_TEMPERATURE=0.7

# ============================================
# Optional: Tavily AI (for research features)
# ============================================
TAVILY_API_KEY=CHANGE_ME_TO_TAVILY_API_KEY

# ============================================
# Optional: Rate Limiting
# ============================================
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ============================================
# CRITICAL: Security & Development Flags
# ============================================
# IMPORTANT: Set to false in production!
ENABLE_DEV_MODE=false
DEV_AUTH_ENABLED=false

# Allowed dev roles (only used if DEV_AUTH_ENABLED=true)
ALLOWED_DEV_ROLES=

# ============================================
# Optional: Logging Configuration
# ============================================
LOG_LEVEL=warn
LOG_DIR=/var/log/mediation-app
LOG_FILE_ENABLED=true

# ============================================
# Optional: Error Tracking (Sentry)
# ============================================
# Get DSN from Sentry Project Settings
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# ============================================
# Optional: Feature Flags
# ============================================
ENABLE_AI_FEATURES=true
ENABLE_FILE_UPLOADS=true
ENABLE_EMAIL_NOTIFICATIONS=true

# ============================================
# SECURITY CHECKLIST BEFORE DEPLOYMENT:
# ============================================
# [ ] Changed ALL "CHANGE_ME" values above
# [ ] Generated new JWT_SECRET (min 64 chars random)
# [ ] Generated new SESSION_SECRET (min 64 chars random)
# [ ] Rotated Supabase keys (generated new ones)
# [ ] Rotated OpenAI API key (generated new one)
# [ ] Set ENABLE_DEV_MODE=false
# [ ] Set DEV_AUTH_ENABLED=false
# [ ] Updated FRONTEND_URL to production domain
# [ ] Updated ALLOWED_ORIGINS to production domains
# [ ] Configured email service (SendGrid/Mailgun)
# [ ] Configured Cloudinary for file storage
# [ ] Set LOG_LEVEL=warn or error
# [ ] Verified DATABASE_URL has sslmode=require
# [ ] Never commit this file to git!
